{% extends "model.html" %}
{% load i18n %}

{% block title %}{% trans "Netuno NG - Manage" %}{% endblock %}

{% block customcss %}
<link rel="stylesheet" type="text/css" href="/static/manage.css" />
<link type="text/css" href="/static/css/custom-theme/jquery-ui-1.8.12.custom.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="/static/timePicker.css" />

<script type="application/javascript" src="/static/jquery-1.5.min.js"></script>
<script type="application/javascript" src="/static/jquery.ui.core.js"></script>
<script type="application/javascript" src="/static/jquery-ui-1.8.12.custom.js"></script>
<script type="application/javascript" src="/static/jquery.ui.datepicker.js"></script>
<script type="application/javascript" src="/static/jquery.timePicker.js"></script>
<script type="application/javascript" src="/static/dateinput.js"></script>
<script type="application/javascript" src="/static/manage.js"></script>
{% endblock %}

{% block content %}
<form name="filter" method="get" action=".">
    <label for="startperiod">{% trans "After day" %}</label>
    <input type="text" id="startperiod" class="date" name="startperiod" value="{{startperiod}}" />
    <label for="endperiod">{% trans "Before day" %}</label>
    <input type="text" id="endperiod" class="date" name="endperiod" value="{{endperiod}}" />
    <input type="submit" id="filter" value="Filter" />
</form>
<div class="working-periods">
    <div class="header row">
        <span class="column executed">{% trans "Activity" %}</span>
        <span class="column task">{% trans "Task" %}</span>
        <span class="column start">{% trans "Started at" %}</span>
        <span class="column end">{% trans "Ended at" %}</span>
        <span class="column time-delta">{% trans "Total time" %}</span>
        <span class="column operations">{% trans "Operations" %}</span>
    </div>
    {% for wp in working_periods %}
    <div id="row{{wp.id}}" class="row">
    <form class="form-wp" name="form-wp{{wp.id}}" action="." method="POST">
        <span class="column  executed">
            {% csrf_token %}
            <input type="hidden" id="working-period" name="working_period" value="{{wp.id|escape}}" />
            <input class="executed" type="text" name="activity" value="{{wp.last_activity|escape}}" />
        </span>
        <span class="column  task">
            <select name="task" class="task">
                <option value="0">&nbsp;</option>
                {% for task in employee.tasks.all %}
                <option value="{{task.id|escape}}"
                    {% ifequal wp.last_task.id task.id %}
                    selected="selected"
                    {% endifequal %}
                >
                    {{task|escape}}
                </option>
                {% endfor %}
            </select>
        </span>
        <span class="column start date">
            <input type="text" name="start-date" class="start-date date"
                    value="{{wp.formatted_start_date|escape}}" />
        </span>
        <span class="column start time">
            <input type="text" name="start-time"  class="start-time time"
                    value="{{wp.formatted_start_time|escape}}" />
        </span>
        <span class="column end date">
            <input type="text" name="end-date"  class="end-date date"
                {% if wp.end %}
                    value="{{wp.formatted_end_date|escape}}" 
                {% endif %}
            />
        </span>
        <span class="column  end time">
            <input type="text" name="end-time"  class="end-time time"
                {% if wp.end %}
                    value="{{wp.formatted_end_time|escape}}"
                {% endif %}
            />
        </span>
        <span class="column time-delta">
        {% if wp.end %}
            {{wp.total_time|floatformat:"2"}} ({{wp.hours|escape}}h{{wp.minutes|escape}})
        {% else %}
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        {% endif %}
        </span>
        <span class="column operations save">
            <input type="submit" name="submit{{wp.id}}" class="update-submit"
                    value="{% trans "Save" %}" />
        </span>
        <span class="column operations delete">
            <input type="submit" name="delete{{wp.id}}" class="delete-submit"
                    value="{% trans "Delete" %}" 
                    alt="{% trans "Are you sure you want to delete this working period?" %}" />
        </span>
    </form>
    </div>
    {% endfor %}
    <a name="add-period" href="/netunong/add/">{% trans "Add period" %}</a>
</div>
{% endblock %}

